---
title: "Smoking Rates in the United States Over Time"
author: "Hunter Huckabay and Ivy Gates"
format: revealjs
editor_options: 
  chunk_output_type: console
---

# Introduction 
According to the American Lung Association, cigarette smoking rates have fallen significantly for both adults and youth since the 1990s. Since 2002, there have been more former smokers than current smokers and more than half of cigarette smokers have quit. However, the National Institute of Health has found that the rate of e-cigarette use has increased from 1.5% in 2011 to 20.8% in 2018. Our goal of this project is to compare cigarette use to e-cigarette use in America. We aim to see what age groups smoking is the most popular as well as the health repercussions smokers face.


```{r}
library(tidyverse)
library(lubridate)
library(janitor)
library(RColorBrewer)
library(ggplot2)
library(tinytable)
```


# Smoking Trends in 2011

```{r}
National <- data.frame(
  Year = 2011,
  Smoke_everday = 15.4,
  Smoke_some_days = 5.7,
  Former_smoker = 25.0,
  Never_Smoked = 52.9
)

long_data <- National %>%
  pivot_longer(cols = -Year, names_to = "Category", values_to = "Value")

ggplot(long_data, aes(x = Category, y = Value, fill = Category)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Smoking in 2011",
    x = "Category",
    y = "Percent"
  ) +
  theme_minimal()
```



## National Smoking Trends from 1995 to 2011

```{r}
Smoking <- read.csv("Current smoking.csv")

national_rates <- Smoking |> 
  group_by (Year) |> 
  summarize(national_average = mean(Smokes))

ggplot( national_rates, aes(x=Year, y = national_average)) + 
  geom_line() + 
  expand_limits( y = 0 ) +
  theme( legend.position = "none")
```

## Average Percent of smokers by state

```{r}
State_Stats <- Smoking |>
  group_by(State) |>
  summarise(AVERAGE = mean(Smokes)) 

library(gt)
State_Stats |> 
  gt() |> 
  tab_header(title = "Smokers by State") |> 
  fmt_number(columns = AVERAGE, decimals = 1)

```

data from above but as a choropleth: 

```{r}
#| eval: FALSE
install.packages("usmap")
install.packages("ggplot2")
```


```{r}
library(plotly)
library(dplyr)

state_data <- State_Stats %>%
  mutate(code = state.abb[match(State, state.name)]) 
# Create interactive choropleth
plot_geo(state_data, locationmode = 'USA-states') %>%
  add_trace(
    z = ~AVERAGE,
    locations = ~code,
    color = ~AVERAGE,
    colors = 'Blues',
    text = ~paste(State, "<br>Avg Smokers: ", round(AVERAGE, 1), "%"),
    hoverinfo = "text"
  ) %>%
  layout(
    title = "Average Percentage of Smokers by State (Interactive)",
    geo = list(scope = 'usa')
  )

```

final presentation: 10 minutes
at least 4 visualizations, at least one of which is a map

map: choropleth color of state = percentage of smokers



